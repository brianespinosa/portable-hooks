import Slide from '../components/slide';
import Logo from '../components/logo';
import Drawing from '../components/drawing';
import { setQueryParamIndex, getQueryParamIndex } from '../utils';
import details from '../details.json';

<CH.Slideshow
  preset="https://codesandbox.io/s/portable-hooks-l9xy3z"
  code={{minZoom: 1.75}}
  autoFocus
  start={getQueryParamIndex()}
  onChange={setQueryParamIndex}
>

```jsx src/Tags.js
import React from 'react';

class Tags extends React.Component {
  render() {
    return <h1>Tags</h1>;
  }
}

export default Tags;
```

<Slide hideFooter>

<Logo />

# {details.title}

## {details.author} | {details.authorDepartment}

</Slide>

---

<Slide>

## Hello!

My name is Brian Espinosa and I am the Director of Engineering for Momentive Analysis.

- Joined Momentive March 2022
- Live in Tacoma, WA
- Using React since v0.12.0

</Slide>

---

<Slide>

# Getting Started

## Before we go anywhere... where are we?

</Slide>

Understand the problem space before we jump in.

---

<Slide>

## Do These Challenges Sound Familar?

- Need to access internal component state or methods
- Product implementation details require continually increasing component props and complexity
- Massive unit test suites with difficult logic to isolate prop and state functionality
- Difficulty composing and reusing across different products due to divergent use cases inside components

</Slide>

Open with question of how many people use React on a daily basis. Ask for hands to stay up with all slide questions.

---

<Slide>

## Why Is This a Problem?

Significant impact on productivity, scale, and cost. 💸

- Multiple component implementations
- Competing implementation details
- Less stability at scale
- Work is slower in complex components
- This is not fun work! 😞

</Slide>

---

<Slide>

## Let's Fix This!

All of these problems can be significantly reduced or eliminated completely with portable state hooks. 🙌

- Patterns for safely sharing component state
- Push implementation details into applications
- Focus on reusability
- Fuctional programming principles

</Slide>

For non-React devs, stick around as everyone will reach a better understanding of some of the problems our front end counterparts are facing.

---

<Slide>

# Code Time

## Where did these problems come from?

</Slide>

Understand the problem space before we jump in.

---

```jsx src/Tags.js
import React from 'react';

class Tags extends React.Component {
  render() {
    return <h1>Tags</h1>;
  }
}

export default Tags;
```

<Slide isSmall>

## Class Components

- State belongs to class
- Methods for setting state 🙏
- Event handlers
- Render function
- Unit tests have to cover everything
- Hoisting state -> controlled components

<Drawing />

</Slide>

FIRST CODE SLIDE

---

```jsx src/Tags.js focus=4
import React from 'react';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  render() {
    return <h1>Tags</h1>;
  }
}

export default Tags;
```

<Slide isSmall>

## Class Components

- State belongs to class
- Methods for setting state 🙏
- Event handlers
- Render function
- Unit tests have to cover everything
- Hoisting state -> controlled components

<Drawing />

</Slide>

---

```jsx src/Tags.js focus=7:21
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  addTag(name) {
    this.setState({ tags: [...this.state.tags, name], newLabel: '' });
  }

  removeTagAtIndex(index) {
    this.setState({ tags: omitIndexes([index], this.state.tags) });
  }

  moveTagForward(index) {
    this.setState({ tags: move(index, index - 1, this.state.tags) });
  }

  moveTagBackward(index) {
    this.setState({ tags: move(index, index + 1, this.state.tags) });
  }

  render() {
    return <h1>Tags</h1>;
  }
}

export default Tags;
```

<Slide isSmall>

## Class Components

- State belongs to class
- Methods for setting state 🙏
- Event handlers
- Render function
- Unit tests have to cover everything
- Hoisting state -> controlled components

<Drawing />

</Slide>

---

```jsx src/Tags.js focus=23:30
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  addTag(name) {
    this.setState({ tags: [...this.state.tags, name], newLabel: '' });
  }

  removeTagAtIndex(index) {
    this.setState({ tags: omitIndexes([index], this.state.tags) });
  }

  moveTagForward(index) {
    this.setState({ tags: move(index, index - 1, this.state.tags) });
  }

  moveTagBackward(index) {
    this.setState({ tags: move(index, index + 1, this.state.tags) });
  }

  handleLabelChange = (event) => {
    this.setState({ newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return <h1>Tags</h1>;
  }
}

export default Tags;
```

<Slide isSmall>

## Class Components

- State belongs to class
- Methods for setting state 🙏
- Event handlers
- Render function
- Unit tests have to cover everything
- Hoisting state -> controlled components

<Drawing />

</Slide>

---

```jsx src/Tags.js focus=32:34
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  addTag(name) {
    this.setState({ tags: [...this.state.tags, name], newLabel: '' });
  }

  removeTagAtIndex(index) {
    this.setState({ tags: omitIndexes([index], this.state.tags) });
  }

  moveTagForward(index) {
    this.setState({ tags: move(index, index - 1, this.state.tags) });
  }

  moveTagBackward(index) {
    this.setState({ tags: move(index, index + 1, this.state.tags) });
  }

  handleLabelChange = (event) => {
    this.setState({ newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return <h1>Tags</h1>;
  }
}

export default Tags;
```

---

```jsx src/Tags.js focus=43:52
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  handleLabelChange(event) {
    this.setState({ newLabel: event.target.value });
  }

  handleSubmit(event) {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  }

  addTag(name) {
    this.setState({ tags: [...this.state.tags, name], newLabel: '' });
  }

  removeTagAtIndex(index) {
    this.setState({ tags: omitIndexes([index], this.state.tags) });
  }

  moveTagForward(index) {
    this.setState({ tags: move(index, index - 1, this.state.tags) });
  }

  moveTagBackward(index) {
    this.setState({ tags: move(index, index + 1, this.state.tags) });
  }

  handleLabelChange = (event) => {
    this.setState({ newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return (
      <>
        <form onSubmit={this.handleSubmit}>
          <input
            type="text"
            value={this.state.newLabel}
            onChange={this.handleLabelChange}
            placeholder="Add a tag..."
          />
        </form>
      </>
    );
  }
}

export default Tags;
```

---

```jsx src/Tags.js focus=53:74
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  handleLabelChange(event) {
    this.setState({ newLabel: event.target.value });
  }

  handleSubmit(event) {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  }

  addTag(name) {
    this.setState({ tags: [...this.state.tags, name], newLabel: '' });
  }

  removeTagAtIndex(index) {
    this.setState({ tags: omitIndexes([index], this.state.tags) });
  }

  moveTagForward(index) {
    this.setState({ tags: move(index, index - 1, this.state.tags) });
  }

  moveTagBackward(index) {
    this.setState({ tags: move(index, index + 1, this.state.tags) });
  }

  handleLabelChange = (event) => {
    this.setState({ newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return (
      <>
        <form onSubmit={this.handleSubmit}>
          <input
            type="text"
            value={this.state.newLabel}
            onChange={this.handleLabelChange}
            placeholder="Add a tag..."
          />
        </form>
        <AnimatePresence>
          {this.state.tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
                ‹
              </button>
              <button
                disabled={this.state.tags.length === i + 1}
                onClick={() => this.moveTagBackward(i)}
              >
                ›
              </button>
              <button onClick={() => this.removeTagAtIndex(i)}>✕</button>
            </m.span>
          ))}
        </AnimatePresence>
      </>
    );
  }
}

export default Tags;
```

</CH.Slideshow>
