import Slide from '../components/slide';
import Logo from '../components/logo';
import Drawing from '../components/drawing';
import { setQueryParamIndex, getQueryParamIndex } from '../utils';
import details from '../details.json';

<CH.Slideshow
  preset="https://codesandbox.io/s/portable-hooks-l9xy3z"
  code={{minZoom: 1.75}}
  autoFocus
  start={getQueryParamIndex()}
  onChange={setQueryParamIndex}
>

```jsx src/Tag.js
import React from 'react';

class Tags extends React.Component {
  render() {
    return <h1>Tags</h1>;
  }
}

export default Tags;
```

<Slide hideFooter>

<Logo />

# {details.title}

## {details.author} | {details.authorDepartment}

</Slide>

---

<Slide>

## Hello!

My name is Brian Espinosa and I am the Director of Engineering for Momentive Analysis.

- Joined Momentive March 2022
- Live in Tacoma, WA
- Using React since v0.12.0

</Slide>

---

<Slide>

# Getting Started

## Before we go anywhere... where are we?

</Slide>

Understand the problem space before we jump in.

---

<Slide>

## Do These Challenges Sound Familar?

- Need to access internal component state or methods
- Product implementation details require continually increasing component props and complexity
- Massive unit test suites with difficult logic to isolate prop and state functionality
- Difficulty composing and reusing across different products due to divergent use cases inside components

</Slide>

Open with question of how many people use React on a daily basis. Ask for hands to stay up with all slide questions.

---

<Slide>

## Why Is This a Problem?

Significant impact on productivity, scale, and cost. 💸

- Multiple component implementations
- Competing implementation details
- Less stability at scale
- Work is slower in complex components
- This is not fun work! 😞

</Slide>

---

<Slide>

## Let's Fix This!

All of these problems can be significantly reduced or eliminated completely with portable state hooks. 🙌

- Patterns for safely sharing component state
- Push implementation details into applications
- Focus on reusability
- Fuctional programming principles

</Slide>

For non-React devs, stick around as everyone will reach a better understanding of some of the problems our front end counterparts are facing.

---

<Slide>

# Code Time

## Where did these problems come from?

</Slide>

Understand the problem space before we jump in.

---

```jsx src/Tag.js
import React from 'react';

class Tags extends React.Component {
  render() {
    return <h1>Tags</h1>;
  }
}

export default Tags;
```

<Slide isSmall>

## Class Components

- State belongs to class
- Methods for setting state 🙏
- Event handlers
- Render function
- Unit tests have to cover everything
- Hoisting state -> controlled components

<Drawing />

</Slide>

FIRST CODE SLIDE

---

```jsx src/Tag.js focus=4
import React from 'react';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  render() {
    return <h1>Tags</h1>;
  }
}

export default Tags;
```

<Slide isSmall>

## Class Components

- State belongs to class
- Methods for setting state 🙏
- Event handlers
- Render function
- Unit tests have to cover everything
- Hoisting state -> controlled components

<Drawing />

</Slide>

---

```jsx src/Tag.js focus=7:33
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  render() {
    return <h1>Tags</h1>;
  }
}

export default Tags;
```

<Slide isSmall>

## Class Components

- State belongs to class
- Methods for setting state 🙏
- Event handlers
- Render function
- Unit tests have to cover everything
- Hoisting state -> controlled components

<Drawing />

</Slide>

---

```jsx src/Tag.js focus=35:42
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleLabelChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return <h1>Tags</h1>;
  }
}

export default Tags;
```

<Slide isSmall>

## Class Components

- State belongs to class
- Methods for setting state 🙏
- Event handlers
- Render function
- Unit tests have to cover everything
- Hoisting state -> controlled components

<Drawing />

</Slide>

---

```jsx src/Tag.js focus=44:46
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleLabelChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return <h1>Tags</h1>;
  }
}

export default Tags;
```

---

```jsx src/Tag.js focus=46:55
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleLabelChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return (
      <>
        <form onSubmit={this.handleSubmit}>
          <input
            type="text"
            value={this.state.newLabel}
            onChange={this.handleLabelChange}
            placeholder="Add a tag..."
          />
        </form>
      </>
    );
  }
}

export default Tags;
```

---

```jsx src/Tag.js focus=56:77
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleLabelChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return (
      <>
        <form onSubmit={this.handleSubmit}>
          <input
            type="text"
            value={this.state.newLabel}
            onChange={this.handleLabelChange}
            placeholder="Add a tag..."
          />
        </form>
        <AnimatePresence>
          {this.state.tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
                ‹
              </button>
              <button
                disabled={this.state.tags?.length === i + 1}
                onClick={() => this.moveTagBackward(i)}
              >
                ›
              </button>
              <button onClick={() => this.removeTagAtIndex(i)}>✕</button>
            </m.span>
          ))}
        </AnimatePresence>
      </>
    );
  }
}

export default Tags;
```

---

```jsx src/Tag.js
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleLabelChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return (
      <>
        <form onSubmit={this.handleSubmit}>
          <input
            type="text"
            value={this.state.newLabel}
            onChange={this.handleLabelChange}
            placeholder="Add a tag..."
          />
        </form>
        <AnimatePresence>
          {this.state.tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
                ‹
              </button>
              <button
                disabled={this.state.tags?.length === i + 1}
                onClick={() => this.moveTagBackward(i)}
              >
                ›
              </button>
              <button onClick={() => this.removeTagAtIndex(i)}>✕</button>
            </m.span>
          ))}
        </AnimatePresence>
      </>
    );
  }
}

export default Tags;
```

<Slide isSmall>

## Function Component

- State hook belongs to render
- Utility setting functions
- Event handlers

</Slide>

---

```jsx src/Tag.js focus=6
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleLabelChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return (
      <>
        <form onSubmit={this.handleSubmit}>
          <input
            type="text"
            value={this.state.newLabel}
            onChange={this.handleLabelChange}
            placeholder="Add a tag..."
          />
        </form>
        <AnimatePresence>
          {this.state.tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
                ‹
              </button>
              <button
                disabled={this.state.tags?.length === i + 1}
                onClick={() => this.moveTagBackward(i)}
              >
                ›
              </button>
              <button onClick={() => this.removeTagAtIndex(i)}>✕</button>
            </m.span>
          ))}
        </AnimatePresence>
      </>
    );
  }
}

export default Tags;
```

<Slide isSmall>

## Function Component

- State hook belongs to render
- Utility setting functions
- Event handlers

</Slide>

---

```jsx src/Tag.js focus=1,6:9
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

class Tags extends React.Component {
  const [state, setState] = useState({
    tags: ['Rocket', 'Pogo', 'Franco'],
    newLabel: '',
  });

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleLabelChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return (
      <>
        <form onSubmit={this.handleSubmit}>
          <input
            type="text"
            value={this.state.newLabel}
            onChange={this.handleLabelChange}
            placeholder="Add a tag..."
          />
        </form>
        <AnimatePresence>
          {this.state.tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
                ‹
              </button>
              <button
                disabled={this.state.tags?.length === i + 1}
                onClick={() => this.moveTagBackward(i)}
              >
                ›
              </button>
              <button onClick={() => this.removeTagAtIndex(i)}>✕</button>
            </m.span>
          ))}
        </AnimatePresence>
      </>
    );
  }
}

export default Tags;
```

<Slide isSmall>

## Function Component

- State hook belongs to render
- Utility setting functions
- Event handlers

</Slide>

---

```jsx src/Tag.js focus=5
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [state, setState] = useState({
    tags: ['Rocket', 'Pogo', 'Franco'],
    newLabel: '',
  });

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleLabelChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={this.handleSubmit}>
        <input
          type="text"
          value={this.state.newLabel}
          onChange={this.handleLabelChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {this.state.tags.map((name, i) => (
          <m.span
            key={i}
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
          >
            {name}
            <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
              ‹
            </button>
            <button
              disabled={this.state.tags?.length === i + 1}
              onClick={() => this.moveTagBackward(i)}
            >
              ›
            </button>
            <button onClick={() => this.removeTagAtIndex(i)}>✕</button>
          </m.span>
        ))}
      </AnimatePresence>
    </>
  );
}
```

<Slide isSmall>

## Function Component

- State hook belongs to render
- Utility setting functions
- Event handlers

</Slide>

---

```jsx src/Tag.js focus=11:25
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [state, setState] = useState({
    tags: ['Rocket', 'Pogo', 'Franco'],
    newLabel: '',
  });

  function addTag(name) {
    setState({ tags: [...state.tags, name], newLabel: '' });
  }

  function removeTagAtIndex(index) {
    setState({ ...state, tags: omitIndexes([index], state.tags) });
  }

  function moveTagForward(index) {
    setState({ ...state, tags: move(index, index - 1, state.tags) });
  }

  function moveTagBackward(index) {
    setState({ ...state, tags: move(index, index + 1, state.tags) });
  }

  handleLabelChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={this.handleSubmit}>
        <input
          type="text"
          value={this.state.newLabel}
          onChange={this.handleLabelChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {this.state.tags.map((name, i) => (
          <m.span
            key={i}
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
          >
            {name}
            <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
              ‹
            </button>
            <button
              disabled={this.state.tags?.length === i + 1}
              onClick={() => this.moveTagBackward(i)}
            >
              ›
            </button>
            <button onClick={() => this.removeTagAtIndex(i)}>✕</button>
          </m.span>
        ))}
      </AnimatePresence>
    </>
  );
}
```

<Slide isSmall>

## Function Component

- State hook belongs to render
- Utility setting functions
- Event handlers

</Slide>

---

```jsx src/Tag.js focus=27:34
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [state, setState] = useState({
    tags: ['Rocket', 'Pogo', 'Franco'],
    newLabel: '',
  });

  function addTag(name) {
    setState({ tags: [...state.tags, name], newLabel: '' });
  }

  function removeTagAtIndex(index) {
    setState({ ...state, tags: omitIndexes([index], state.tags) });
  }

  function moveTagForward(index) {
    setState({ ...state, tags: move(index, index - 1, state.tags) });
  }

  function moveTagBackward(index) {
    setState({ ...state, tags: move(index, index + 1, state.tags) });
  }

  const handleLabelChange = (event) => {
    setState({ ...state, newLabel: event.target.value });
  };

  const handleSubmit = (event) => {
    addTag(state.newLabel);
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={this.handleSubmit}>
        <input
          type="text"
          value={this.state.newLabel}
          onChange={this.handleLabelChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {this.state.tags.map((name, i) => (
          <m.span
            key={i}
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
          >
            {name}
            <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
              ‹
            </button>
            <button
              disabled={this.state.tags?.length === i + 1}
              onClick={() => this.moveTagBackward(i)}
            >
              ›
            </button>
            <button onClick={() => this.removeTagAtIndex(i)}>✕</button>
          </m.span>
        ))}
      </AnimatePresence>
    </>
  );
}
```

<Slide isSmall>

## Function Component

- State hook belongs to render
- Utility setting functions
- Event handlers

</Slide>

---

```jsx src/Tag.js focus=38:68
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [state, setState] = useState({
    tags: ['Rocket', 'Pogo', 'Franco'],
    newLabel: '',
  });

  function addTag(name) {
    setState({ tags: [...state.tags, name], newLabel: '' });
  }

  function removeTagAtIndex(index) {
    setState({ ...state, tags: omitIndexes([index], state.tags) });
  }

  function moveTagForward(index) {
    setState({ ...state, tags: move(index, index - 1, state.tags) });
  }

  function moveTagBackward(index) {
    setState({ ...state, tags: move(index, index + 1, state.tags) });
  }

  const handleLabelChange = (event) => {
    setState({ ...state, newLabel: event.target.value });
  };

  const handleSubmit = (event) => {
    addTag(state.newLabel);
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={state.newLabel}
          onChange={handleLabelChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {state.tags?.length &&
          state.tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‹
              </button>
              <button
                disabled={state.tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ›
              </button>
              <button onClick={() => removeTagAtIndex(i)}>✕</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

<Slide isSmall>

## Function Component

- State hook belongs to render
- Utility setting functions
- Event handlers

</Slide>

---

```jsx src/Tag.js
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [state, setState] = useState({
    tags: ['Rocket', 'Pogo', 'Franco'],
    newLabel: '',
  });

  function addTag(name) {
    setState({ tags: [...state.tags, name], newLabel: '' });
  }

  function removeTagAtIndex(index) {
    setState({ ...state, tags: omitIndexes([index], state.tags) });
  }

  function moveTagForward(index) {
    setState({ ...state, tags: move(index, index - 1, state.tags) });
  }

  function moveTagBackward(index) {
    setState({ ...state, tags: move(index, index + 1, state.tags) });
  }

  const handleLabelChange = (event) => {
    setState({ ...state, newLabel: event.target.value });
  };

  const handleSubmit = (event) => {
    addTag(state.newLabel);
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={state.newLabel}
          onChange={handleLabelChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {state.tags?.length &&
          state.tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‹
              </button>
              <button
                disabled={state.tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ›
              </button>
              <button onClick={() => removeTagAtIndex(i)}>✕</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

---

<Slide isSmall>

## Most Common Function Component

- Uncontrolled with internal state and some props
- Prop surface area continues to grow as we need to give access inside the component
- Logic becomes increasingly complex once we have a 🔥 Propocalypse™
- Have to balance functionality both controlled and uncontrolled component styles
- Begin to rely on anti-patterns passing state back up the tree

</Slide>

---

<Slide isSmall>

## What If We Only Made Controlled Components?

- Component logic becomes more simple
- Chances for a Propocalypse™ are reduced
- But... how do we still help developers do their jobs?

</Slide>

---

```jsx src/Tag.js focus=6:9
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [state, setState] = useState({
    tags: ['Rocket', 'Pogo', 'Franco'],
    newLabel: '',
  });

  function addTag(name) {
    setState({ tags: [...state.tags, name], newLabel: '' });
  }

  function removeTagAtIndex(index) {
    setState({ ...state, tags: omitIndexes([index], state.tags) });
  }

  function moveTagForward(index) {
    setState({ ...state, tags: move(index, index - 1, state.tags) });
  }

  function moveTagBackward(index) {
    setState({ ...state, tags: move(index, index + 1, state.tags) });
  }

  const handleLabelChange = (event) => {
    setState({ ...state, newLabel: event.target.value });
  };

  const handleSubmit = (event) => {
    addTag(state.newLabel);
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={state.newLabel}
          onChange={handleLabelChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {state.tags?.length &&
          state.tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‹
              </button>
              <button
                disabled={state.tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ›
              </button>
              <button onClick={() => removeTagAtIndex(i)}>✕</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

---

```jsx src/Tag.js
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [tags, setTags] = useState(['Arsenal']);
  const [newLabel, setNewLabel] = useState('');

  function addTag(name) {
    setTags([...tags, name]);
  }

  function removeTagAtIndex(index) {
    setTags(omitIndexes([index], tags));
  }

  function moveTagForward(index) {
    setTags(move(index, index - 1, tags));
  }

  function moveTagBackward(index) {
    setTags(move(index, index + 1, tags));
  }

  const handleLabelChange = (event) => {
    setNewLabel(event.target.value);
  };

  const handleSubmit = (event) => {
    addTag?.(newLabel);
    setNewLabel('');
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={newLabel}
          onChange={handleLabelChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {tags?.length &&
          tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‹
              </button>
              <button
                disabled={tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ›
              </button>
              <button onClick={() => removeTagAtIndex(i)}>✕</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

---

```jsx src/Tag.js focus=6,9:23
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [tags, setTags] = useState(['Arsenal']);
  const [newLabel, setNewLabel] = useState('');

  function addTag(name) {
    setTags([...tags, name]);
  }

  function removeTagAtIndex(index) {
    setTags(omitIndexes([index], tags));
  }

  function moveTagForward(index) {
    setTags(move(index, index - 1, tags));
  }

  function moveTagBackward(index) {
    setTags(move(index, index + 1, tags));
  }

  const handleLabelChange = (event) => {
    setNewLabel(event.target.value);
  };

  const handleSubmit = (event) => {
    addTag?.(newLabel);
    setNewLabel('');
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={newLabel}
          onChange={handleLabelChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {tags?.length &&
          tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‹
              </button>
              <button
                disabled={tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ›
              </button>
              <button onClick={() => removeTagAtIndex(i)}>✕</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

---

```jsx src/useTagState.js
import { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';

export default function useTabState() {
  const [tags, setTags] = useState(['Arsenal']);

  function addTag(name) {
    setTags([...tags, name]);
  }

  function removeTagAtIndex(index) {
    setTags(omitIndexes([index], tags));
  }

  function moveTagForward(index) {
    setTags(move(index, index - 1, tags));
  }

  function moveTagBackward(index) {
    setTags(move(index, index + 1, tags));
  }
}
```

---

```jsx src/useTagState.js focus=5[16:22],23:29
import { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';

export default function useTabState({ initialTags } = {}) {
  const [tags, setTags] = useState(initialTags || []);

  function addTag(name) {
    setTags([...tags, name]);
  }

  function removeTagAtIndex(index) {
    setTags(omitIndexes([index], tags));
  }

  function moveTagForward(index) {
    setTags(move(index, index - 1, tags));
  }

  function moveTagBackward(index) {
    setTags(move(index, index + 1, tags));
  }

  return {
    addTag,
    moveTagBackward,
    moveTagForward,
    removeTagAtIndex,
    tags,
  };
}
```

---

```jsx src/Tag.js focus=6,9:23
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [tags, setTags] = useState(['Arsenal']);
  const [newLabel, setNewLabel] = useState('');

  function addTag(name) {
    setTags([...tags, name]);
  }

  function removeTagAtIndex(index) {
    setTags(omitIndexes([index], tags));
  }

  function moveTagForward(index) {
    setTags(move(index, index - 1, tags));
  }

  function moveTagBackward(index) {
    setTags(move(index, index + 1, tags));
  }

  const handleLabelChange = (event) => {
    setNewLabel(event.target.value);
  };

  const handleSubmit = (event) => {
    addTag?.(newLabel);
    setNewLabel('');
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={newLabel}
          onChange={handleLabelChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {tags?.length &&
          tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‹
              </button>
              <button
                disabled={tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ›
              </button>
              <button onClick={() => removeTagAtIndex(i)}>✕</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

---

```jsx src/Tag.js focus=3,7:8
import React, { useState } from 'react';
import { AnimatePresence, m } from 'framer-motion';
import useTagState from './useTagState';

export default function Tag() {
  const [newLabel, setNewLabel] = useState('');
  const { addTag, moveTagBackward, moveTagForward, removeTagAtIndex, tags } =
    useTagState();

  const handleLabelChange = (event) => {
    setNewLabel(event.target.value);
  };

  const handleSubmit = (event) => {
    addTag?.(newLabel);
    setNewLabel('');
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={newLabel}
          onChange={handleLabelChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {tags?.length &&
          tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‹
              </button>
              <button
                disabled={tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ›
              </button>
              <button onClick={() => removeTagAtIndex(i)}>✕</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

---

```jsx src/Tag.js
import React, { useState } from 'react';
import { AnimatePresence, m } from 'framer-motion';
import useTagState from './useTagState';

export default function Tag() {
  const [newLabel, setNewLabel] = useState('');
  const { addTag, moveTagBackward, moveTagForward, removeTagAtIndex, tags } =
    useTagState();

  const handleLabelChange = (event) => {
    setNewLabel(event.target.value);
  };

  const handleSubmit = (event) => {
    addTag?.(newLabel);
    setNewLabel('');
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={newLabel}
          onChange={handleLabelChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {tags?.length &&
          tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‹
              </button>
              <button
                disabled={tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ›
              </button>
              <button onClick={() => removeTagAtIndex(i)}>✕</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

---

```jsx src/useTagState.js
import { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';

export default function useTabState({ initialTags } = {}) {
  const [tags, setTags] = useState(initialTags || []);

  function addTag(name) {
    setTags([...tags, name]);
  }

  function removeTagAtIndex(index) {
    setTags(omitIndexes([index], tags));
  }

  function moveTagForward(index) {
    setTags(move(index, index - 1, tags));
  }

  function moveTagBackward(index) {
    setTags(move(index, index + 1, tags));
  }

  return {
    addTag,
    moveTagBackward,
    moveTagForward,
    removeTagAtIndex,
    tags,
  };
}
```

---

```jsx src/App.js
import Tag from './Tag';

export default function App() {
  return <Tag />;
}
```

---

```jsx src/App.js focus=2,5
import Tag from './Tag';
import useTagState from './useTagState';

export default function App() {
  const tagState = useTagState({ initialTags: ['foo', 'bar'] });

  return <Tag />;
}
```

---

```jsx src/App.js focus=7[15:27]
import Tag from './Tag';
import useTagState from './useTagState';

export default function App() {
  const tagState = useTagState({ initialTags: ['foo', 'bar'] });

  return <Tag {...tagState} />;
}
```

---

```jsx src/App.js
import Tag from './Tag';
import useTagState from './useTagState';

export default function App() {
  const tagStateA = useTagState({ initialTags: ['foo', 'bar'] });
  const tagStateB = useTagState({ initialTags: ['baz', 'bat'] });

  return (
    <>
      <Tag {...tagStateA} />
      <Tag {...tagStateB} />
    </>
  );
}
```

---

```jsx src/Tag.js focus=3,7:8
import React, { useState } from 'react';
import { AnimatePresence, m } from 'framer-motion';
import useTagState from './useTagState';

export default function Tag() {
  const [newLabel, setNewLabel] = useState('');
  const { addTag, moveTagBackward, moveTagForward, removeTagAtIndex, tags } =
    useTagState();

  const handleLabelChange = (event) => {
    setNewLabel(event.target.value);
  };

  const handleSubmit = (event) => {
    addTag?.(newLabel);
    setNewLabel('');
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={newLabel}
          onChange={handleLabelChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {tags?.length &&
          tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‹
              </button>
              <button
                disabled={tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ›
              </button>
              <button onClick={() => removeTagAtIndex(i)}>✕</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

---

```jsx src/Tag.js
import React, { useState } from 'react';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag({
  addTag,
  moveTagBackward,
  moveTagForward,
  removeTagAtIndex,
  tags,
} = {}) {
  const [newLabel, setNewLabel] = useState('');

  const handleLabelChange = (event) => {
    setNewLabel(event.target.value);
  };

  const handleSubmit = (event) => {
    addTag?.(newLabel);
    setNewLabel('');
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={newLabel}
          onChange={handleLabelChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {tags?.map((name, i) => (
          <m.span
            key={i}
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
          >
            {name}
            <button disabled={i === 0} onClick={() => moveTagForward(i)}>
              ‹
            </button>
            <button
              disabled={tags?.length === i + 1}
              onClick={() => moveTagBackward(i)}
            >
              ›
            </button>
            <button onClick={() => removeTagAtIndex(i)}>✕</button>
          </m.span>
        ))}
      </AnimatePresence>
    </>
  );
}
```

---

```jsx src/App.js
import Tag from './Tag';
import useTagState from './useTagState';

export default function App() {
  const tagStateA = useTagState({ initialTags: ['foo', 'bar'] });
  const tagStateB = useTagState({ initialTags: ['baz', 'bat'] });

  return (
    <>
      <Tag {...tagStateA} />
      <Tag {...tagStateB} />
    </>
  );
}
```

---

```jsx src/App.js
import Tag from './Tag';
import useTagState from './useTagState';

export default function App() {
  const tagStateA = useTagState({ initialTags: ['foo', 'bar'] });
  const tagStateB = useTagState({ initialTags: ['baz', 'bat'] });

  return (
    <>
      <Tag />
      <Tag {...tagStateB} />
    </>
  );
}
```

---

```jsx src/App.js focus=7:11,17
import Tag from './Tag';
import useTagState from './useTagState';

export default function App() {
  const tagStateA = useTagState({ initialTags: ['foo', 'bar'] });
  const tagStateB = useTagState({ initialTags: ['baz', 'bat'] });
  const { removeTagAtIndex, ...tagStateC } = useTagState();
  function trackDelete(index) {
    removeTagAtIndex(index);
    alert(`Deleted tag at index ${index}`);
  }

  return (
    <>
      <Tag />
      <Tag {...tagStateB} />
      <Tag {...tagStateC} removeTagAtIndex={trackDelete} />
    </>
  );
}
```

---

```jsx src/App.js focus=12:15,22:25
import Tag from './Tag';
import useTagState from './useTagState';

export default function App() {
  const tagStateA = useTagState({ initialTags: ['foo', 'bar'] });
  const tagStateB = useTagState({ initialTags: ['baz', 'bat'] });
  const { removeTagAtIndex, ...tagStateC } = useTagState();
  function trackDelete(index) {
    removeTagAtIndex(index);
    alert(`Deleted tag at index ${index}`);
  }
  const tagStateD = useTagState();
  const { tags } = tagStateD;

  const myUrlParams = new URLSearchParams({ tags });

  return (
    <>
      <Tag />
      <Tag {...tagStateB} />
      <Tag {...tagStateC} removeTagAtIndex={trackDelete} />
      <Tag {...tagStateD} />
      <pre>
        <code>{myUrlParams.toString()}</code>
      </pre>
    </>
  );
}
```

</CH.Slideshow>
