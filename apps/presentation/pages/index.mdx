import Slide from '../components/slide';
import Logo from '../components/logo';
import Drawing from '../components/drawing';
import { setQueryParamIndex, getQueryParamIndex } from '../utils';
import details from '../details.json';

<CH.Slideshow
  preset="https://codesandbox.io/s/portable-hooks-l9xy3z"
  code={{minZoom: 1.75}}
  autoFocus
  start={getQueryParamIndex()}
  onChange={setQueryParamIndex}
>

```jsx src/Tag.js
import React from 'react';

class Tags extends React.Component {
  render() {
    return <h1>Tags</h1>;
  }
}

export default Tags;
```

<Slide hideFooter>

<Logo />

# {details.title}

## {details.author} | {details.authorDepartment}

</Slide>

---

<Slide>

## Hello!

My name is Brian Espinosa and I am the Director of Engineering for Momentive Analysis.

- Joined Momentive March 2022
- Live in Tacoma, WA
- Using React since v0.12.0

</Slide>

---

<Slide>

# Getting Started

## Before we go anywhere... where are we?

</Slide>

---

<Slide isTop>

## Do These Challenges Sound Familar?

</Slide>

---

<Slide isTop>

## Do These Challenges Sound Familar?

- Need to access internal component state or methods

</Slide>

---

<Slide isTop>

## Do These Challenges Sound Familar?

- Need to access internal component state or methods
- Growing prop complexity to support competing product use cases

</Slide>

---

<Slide isTop>

## Do These Challenges Sound Familar?

- Need to access internal component state or methods
- Growing prop complexity to support competing product use cases
- Massive unit tests that must cover prop, state, and UX functionality

</Slide>

---

<Slide isTop>

## Do These Challenges Sound Familar?

- Need to access internal component state or methods
- Growing prop complexity to support competing product use cases
- Massive unit tests that must cover prop, state, and UX functionality
- Difficulty composing or reusing components across products with diverging use cases

</Slide>

---

<Slide>

## Why Is This a Problem?

Significant impact on productivity, scale, and cost. üí∏ üí£ üòû

</Slide>

---

<Slide>

## Let's Fix This!

All of these problems can be significantly reduced or eliminated completely with portable state hooks. üôå

</Slide>

---

<Slide>

## Example Component

Allows us to add, move, reorder, and <br/> remove tags

<img src="tags.png" alt="Example tag component" style={{ maxWidth: '50%' }} />

</Slide>

---

<Slide>

## Example Component

Allows us to add, move, reorder, and <br/> remove dogs

<img
  src="degs.jpeg"
  alt=""
  style={{
    maxWidth: '30%',
    position: 'absolute',
    right: 0,
    bottom: '4vw',
    borderRadius: '100%',
  }}
/>

<img src="tags.png" alt="Example tag component" style={{ maxWidth: '50%' }} />

</Slide>

---

<Slide>

# Code Time

## Where did these problems come from?

</Slide>

---

<Slide>

## Class Components

Thanks for coming to the talk! üëã

</Slide>

---

```jsx src/Tag.js
import React from 'react';

class Tags extends React.Component {
  render() {
    return <h1>Tags</h1>;
  }
}

export default Tags;
```

<Slide isSmall>

## Class Components

Relax... class components are okay (sometimes)

<Drawing />

</Slide>

---

<Slide isSmall>

## Class Components

<Drawing />

</Slide>

---

```jsx src/Tag.js focus=4
import React from 'react';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  render() {
    return <h1>Tags</h1>;
  }
}

export default Tags;
```

<Slide isSmall>

## Class Components

<Drawing />

</Slide>

---

<Slide isSmall>

## Class Components

- State belongs to class

<Drawing />

</Slide>

---

<Slide isSmall>

## Class Components

- State belongs to class
- Complex, combined state object

<Drawing />

</Slide>

---

```jsx src/Tag.js focus=7:33
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  render() {
    return <h1>Tags</h1>;
  }
}

export default Tags;
```

<Slide isSmall>

## Class Components

- State belongs to class
- Complex, combined state object

<Drawing />

</Slide>

---

<Slide isSmall>

## Class Components

- State belongs to class
- Complex, combined state object
- Methods for setting state üôè

<Drawing />

</Slide>

---

```jsx src/Tag.js focus=35:42
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleInputChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return <h1>Tags</h1>;
  }
}

export default Tags;
```

<Slide isSmall>

## Class Components

- State belongs to class
- Complex, combined state object
- Methods for setting state üôè

<Drawing />

</Slide>

---

<Slide isSmall>

## Class Components

- State belongs to class
- Complex, combined state object
- Methods for setting state üôè
- Event handlers

<Drawing />

</Slide>

- Render function
- Unit tests have to cover everything
- Hoisting state -> controlled components

---

```jsx src/Tag.js focus=44:46
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleInputChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return <h1>Tags</h1>;
  }
}

export default Tags;
```

---

```jsx src/Tag.js focus=46:55
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleInputChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return (
      <>
        <form onSubmit={this.handleSubmit}>
          <input
            type="text"
            value={this.state.newLabel}
            onChange={this.handleInputChange}
            placeholder="Add a tag..."
          />
        </form>
      </>
    );
  }
}

export default Tags;
```

---

```jsx src/Tag.js focus=56:77
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleInputChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return (
      <>
        <form onSubmit={this.handleSubmit}>
          <input
            type="text"
            value={this.state.newLabel}
            onChange={this.handleInputChange}
            placeholder="Add a tag..."
          />
        </form>
        <AnimatePresence>
          {this.state.tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={this.state.tags?.length === i + 1}
                onClick={() => this.moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => this.removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
        </AnimatePresence>
      </>
    );
  }
}

export default Tags;
```

---

```jsx src/Tag.js
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleInputChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return (
      <>
        <form onSubmit={this.handleSubmit}>
          <input
            type="text"
            value={this.state.newLabel}
            onChange={this.handleInputChange}
            placeholder="Add a tag..."
          />
        </form>
        <AnimatePresence>
          {this.state.tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={this.state.tags?.length === i + 1}
                onClick={() => this.moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => this.removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
        </AnimatePresence>
      </>
    );
  }
}

export default Tags;
```

---

<Slide>

## Quick Refactor

Keep our class state/methods in mind üëÄ

</Slide>

---

```jsx src/Tag.js
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleInputChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return (
      <>
        <form onSubmit={this.handleSubmit}>
          <input
            type="text"
            value={this.state.newLabel}
            onChange={this.handleInputChange}
            placeholder="Add a tag..."
          />
        </form>
        <AnimatePresence>
          {this.state.tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={this.state.tags?.length === i + 1}
                onClick={() => this.moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => this.removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
        </AnimatePresence>
      </>
    );
  }
}

export default Tags;
```

<Slide isSmall>

## Function Component

</Slide>

---

```jsx src/Tag.js focus=6
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleInputChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return (
      <>
        <form onSubmit={this.handleSubmit}>
          <input
            type="text"
            value={this.state.newLabel}
            onChange={this.handleInputChange}
            placeholder="Add a tag..."
          />
        </form>
        <AnimatePresence>
          {this.state.tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={this.state.tags?.length === i + 1}
                onClick={() => this.moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => this.removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
        </AnimatePresence>
      </>
    );
  }
}

export default Tags;
```

<Slide isSmall>

## Function Component

</Slide>

---

```jsx src/Tag.js focus=1,6:9
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

class Tags extends React.Component {
  const [state, setState] = useState({
    tags: ['Rocket', 'Pogo', 'Franco'],
    newLabel: '',
  });

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleInputChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return (
      <>
        <form onSubmit={this.handleSubmit}>
          <input
            type="text"
            value={this.state.newLabel}
            onChange={this.handleInputChange}
            placeholder="Add a tag..."
          />
        </form>
        <AnimatePresence>
          {this.state.tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={this.state.tags?.length === i + 1}
                onClick={() => this.moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => this.removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
        </AnimatePresence>
      </>
    );
  }
}

export default Tags;
```

<Slide isSmall>

## Function Component

</Slide>

---

<Slide isSmall>

## Function Component

- State now belongs to the component render

</Slide>

---

<Slide isSmall>

## Function Component

- State now belongs to the component render
- Initialize with dogs for demo

</Slide>

---

```jsx src/Tag.js focus=5
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [state, setState] = useState({
    tags: ['Rocket', 'Pogo', 'Franco'],
    newLabel: '',
  });

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleInputChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={this.handleSubmit}>
        <input
          type="text"
          value={this.state.newLabel}
          onChange={this.handleInputChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {this.state.tags.map((name, i) => (
          <m.span
            key={i}
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
          >
            {name}
            <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
              ‚Äπ
            </button>
            <button
              disabled={this.state.tags?.length === i + 1}
              onClick={() => this.moveTagBackward(i)}
            >
              ‚Ä∫
            </button>
            <button onClick={() => this.removeTagAtIndex(i)}>‚úï</button>
          </m.span>
        ))}
      </AnimatePresence>
    </>
  );
}
```

<Slide isSmall>

## Function Component

- State now belongs to the component render
- Initialize with dogs for demo

</Slide>

---

<Slide isSmall>

## Function Component

- State now belongs to the component render
- Initialize with dogs for demo
- Class becomes function

</Slide>

---

```jsx src/Tag.js focus=11:37
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [state, setState] = useState({
    tags: ['Rocket', 'Pogo', 'Franco'],
    newLabel: '',
  });

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleInputChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={this.handleSubmit}>
        <input
          type="text"
          value={this.state.newLabel}
          onChange={this.handleInputChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {this.state.tags.map((name, i) => (
          <m.span
            key={i}
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
          >
            {name}
            <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
              ‚Äπ
            </button>
            <button
              disabled={this.state.tags?.length === i + 1}
              onClick={() => this.moveTagBackward(i)}
            >
              ‚Ä∫
            </button>
            <button onClick={() => this.removeTagAtIndex(i)}>‚úï</button>
          </m.span>
        ))}
      </AnimatePresence>
    </>
  );
}
```

<Slide isSmall>

## Function Component

- State now belongs to the component render
- Initialize with dogs for demo
- Class becomes function

</Slide>

---

```jsx src/Tag.js focus=11:25
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [state, setState] = useState({
    tags: ['Rocket', 'Pogo', 'Franco'],
    newLabel: '',
  });

  function addTag(name) {
    setState({ tags: [...state.tags, name], newLabel: '' });
  }

  function removeTagAtIndex(index) {
    setState({ ...state, tags: omitIndexes([index], state.tags) });
  }

  function moveTagForward(index) {
    setState({ ...state, tags: move(index, index - 1, state.tags) });
  }

  function moveTagBackward(index) {
    setState({ ...state, tags: move(index, index + 1, state.tags) });
  }

  handleInputChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={this.handleSubmit}>
        <input
          type="text"
          value={this.state.newLabel}
          onChange={this.handleInputChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {this.state.tags.map((name, i) => (
          <m.span
            key={i}
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
          >
            {name}
            <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
              ‚Äπ
            </button>
            <button
              disabled={this.state.tags?.length === i + 1}
              onClick={() => this.moveTagBackward(i)}
            >
              ‚Ä∫
            </button>
            <button onClick={() => this.removeTagAtIndex(i)}>‚úï</button>
          </m.span>
        ))}
      </AnimatePresence>
    </>
  );
}
```

<Slide isSmall>

## Function Component

- State now belongs to the component render
- Initialize with dogs for demo
- Class becomes function

</Slide>

---

<Slide isSmall>

## Function Component

- State now belongs to the component render
- Initialize with dogs for demo
- Class becomes function
- Methods become functions

</Slide>

---

```jsx src/Tag.js focus=27:34
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [state, setState] = useState({
    tags: ['Rocket', 'Pogo', 'Franco'],
    newLabel: '',
  });

  function addTag(name) {
    setState({ tags: [...state.tags, name], newLabel: '' });
  }

  function removeTagAtIndex(index) {
    setState({ ...state, tags: omitIndexes([index], state.tags) });
  }

  function moveTagForward(index) {
    setState({ ...state, tags: move(index, index - 1, state.tags) });
  }

  function moveTagBackward(index) {
    setState({ ...state, tags: move(index, index + 1, state.tags) });
  }

  handleInputChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={this.handleSubmit}>
        <input
          type="text"
          value={this.state.newLabel}
          onChange={this.handleInputChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {this.state.tags.map((name, i) => (
          <m.span
            key={i}
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
          >
            {name}
            <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
              ‚Äπ
            </button>
            <button
              disabled={this.state.tags?.length === i + 1}
              onClick={() => this.moveTagBackward(i)}
            >
              ‚Ä∫
            </button>
            <button onClick={() => this.removeTagAtIndex(i)}>‚úï</button>
          </m.span>
        ))}
      </AnimatePresence>
    </>
  );
}
```

<Slide isSmall>

## Function Component

- State now belongs to the component render
- Initialize with dogs for demo
- Class becomes function
- Methods become functions

</Slide>

---

```jsx src/Tag.js focus=27:34
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [state, setState] = useState({
    tags: ['Rocket', 'Pogo', 'Franco'],
    newLabel: '',
  });

  function addTag(name) {
    setState({ tags: [...state.tags, name], newLabel: '' });
  }

  function removeTagAtIndex(index) {
    setState({ ...state, tags: omitIndexes([index], state.tags) });
  }

  function moveTagForward(index) {
    setState({ ...state, tags: move(index, index - 1, state.tags) });
  }

  function moveTagBackward(index) {
    setState({ ...state, tags: move(index, index + 1, state.tags) });
  }

  const handleInputChange = (event) => {
    setState({ ...state, newLabel: event.target.value });
  };

  const handleSubmit = (event) => {
    addTag(state.newLabel);
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={this.handleSubmit}>
        <input
          type="text"
          value={this.state.newLabel}
          onChange={this.handleInputChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {this.state.tags.map((name, i) => (
          <m.span
            key={i}
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
          >
            {name}
            <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
              ‚Äπ
            </button>
            <button
              disabled={this.state.tags?.length === i + 1}
              onClick={() => this.moveTagBackward(i)}
            >
              ‚Ä∫
            </button>
            <button onClick={() => this.removeTagAtIndex(i)}>‚úï</button>
          </m.span>
        ))}
      </AnimatePresence>
    </>
  );
}
```

<Slide isSmall>

## Function Component

- State now belongs to the component render
- Initialize with dogs for demo
- Class becomes function
- Methods become functions

</Slide>

---

<Slide isSmall>

## Function Component

- State now belongs to the component render
- Initialize with dogs for demo
- Class becomes function
- Methods become functions
- Handlers keep arrow functions for binding

</Slide>

---

```jsx src/Tag.js focus=38:67
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [state, setState] = useState({
    tags: ['Rocket', 'Pogo', 'Franco'],
    newLabel: '',
  });

  function addTag(name) {
    setState({ tags: [...state.tags, name], newLabel: '' });
  }

  function removeTagAtIndex(index) {
    setState({ ...state, tags: omitIndexes([index], state.tags) });
  }

  function moveTagForward(index) {
    setState({ ...state, tags: move(index, index - 1, state.tags) });
  }

  function moveTagBackward(index) {
    setState({ ...state, tags: move(index, index + 1, state.tags) });
  }

  const handleInputChange = (event) => {
    setState({ ...state, newLabel: event.target.value });
  };

  const handleSubmit = (event) => {
    addTag(state.newLabel);
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={this.handleSubmit}>
        <input
          type="text"
          value={this.state.newLabel}
          onChange={this.handleInputChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {this.state.tags.map((name, i) => (
          <m.span
            key={i}
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
          >
            {name}
            <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
              ‚Äπ
            </button>
            <button
              disabled={this.state.tags?.length === i + 1}
              onClick={() => this.moveTagBackward(i)}
            >
              ‚Ä∫
            </button>
            <button onClick={() => this.removeTagAtIndex(i)}>‚úï</button>
          </m.span>
        ))}
      </AnimatePresence>
    </>
  );
}
```

<Slide isSmall>

## Function Component

- State now belongs to the component render
- Initialize with dogs for demo
- Class becomes function
- Methods become functions
- Handlers keep arrow functions for binding

</Slide>

---

```jsx src/Tag.js focus=38:68
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [state, setState] = useState({
    tags: ['Rocket', 'Pogo', 'Franco'],
    newLabel: '',
  });

  function addTag(name) {
    setState({ tags: [...state.tags, name], newLabel: '' });
  }

  function removeTagAtIndex(index) {
    setState({ ...state, tags: omitIndexes([index], state.tags) });
  }

  function moveTagForward(index) {
    setState({ ...state, tags: move(index, index - 1, state.tags) });
  }

  function moveTagBackward(index) {
    setState({ ...state, tags: move(index, index + 1, state.tags) });
  }

  const handleInputChange = (event) => {
    setState({ ...state, newLabel: event.target.value });
  };

  const handleSubmit = (event) => {
    addTag(state.newLabel);
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={state.newLabel}
          onChange={handleInputChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {state.tags?.length &&
          state.tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={state.tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

<Slide isSmall>

## Function Component

- State now belongs to the component render
- Initialize with dogs for demo
- Class becomes function
- Methods become functions
- Handlers keep arrow functions for binding

</Slide>

---

<Slide isSmall>

## Function Component

- State now belongs to the component render
- Initialize with dogs for demo
- Class becomes function
- Methods become functions
- Handlers keep arrow functions for binding
- No more "this"

</Slide>

---

```jsx src/Tag.js
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [state, setState] = useState({
    tags: ['Rocket', 'Pogo', 'Franco'],
    newLabel: '',
  });

  function addTag(name) {
    setState({ tags: [...state.tags, name], newLabel: '' });
  }

  function removeTagAtIndex(index) {
    setState({ ...state, tags: omitIndexes([index], state.tags) });
  }

  function moveTagForward(index) {
    setState({ ...state, tags: move(index, index - 1, state.tags) });
  }

  function moveTagBackward(index) {
    setState({ ...state, tags: move(index, index + 1, state.tags) });
  }

  const handleInputChange = (event) => {
    setState({ ...state, newLabel: event.target.value });
  };

  const handleSubmit = (event) => {
    addTag(state.newLabel);
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={state.newLabel}
          onChange={handleInputChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {state.tags?.length &&
          state.tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={state.tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

---

<Slide>

# Let's Start the Talk

## Finally...

</Slide>

---

<Slide isTop>

## Common Function Component Issues

</Slide>

---

<Slide isTop>

## Common Function Component Issues

- Begin as uncontrolled pattern üåû üïä

</Slide>

---

<Slide isTop>

## Common Function Component Issues

- Begin as uncontrolled pattern üåû üïä
- Competing feature requests... üå•

</Slide>

---

<Slide isTop>

## Common Function Component Issues

<img
  src="https://c.tenor.com/-kZOB16tELEAAAAM/this-is-fine-fire.gif"
  alt="This Is Fine"
  style={{ position: 'absolute', right: 0, top: '30vw', width: '35vw' }}
/>

- Begin as uncontrolled pattern üåû üïä
- Competing feature requests... üå•
- Propocalypse‚Ñ¢

</Slide>

---

<Slide isTop>

## Common Function Component Issues

<img
  src="https://c.tenor.com/-kZOB16tELEAAAAM/this-is-fine-fire.gif"
  alt="This Is Fine"
  style={{ position: 'absolute', right: 0, top: '30vw', width: '35vw' }}
/>

- Begin as uncontrolled pattern üåû üïä
- Competing feature requests... üå•
- Propocalypse‚Ñ¢
- Imperative instead of declarative

</Slide>

---

<Slide isTop>

## Common Function Component Issues

<img
  src="https://c.tenor.com/-kZOB16tELEAAAAM/this-is-fine-fire.gif"
  alt="This Is Fine"
  style={{ position: 'absolute', right: 0, top: '30vw', width: '35vw' }}
/>

- Begin as uncontrolled pattern üåû üïä
- Competing feature requests... üå•
- Propocalypse‚Ñ¢
- Imperative instead of declarative
- Increasingly complex tests

</Slide>

---

<Slide isTop>

## What If We Only Made Controlled Components?

</Slide>

---

<Slide isTop>

## What If We Only Made Controlled Components?

- API surface area significantly reduced

</Slide>

---

<Slide isTop>

## What If We Only Made Controlled Components?

- API surface area significantly reduced
- Testing becomes easier

</Slide>

---

<Slide isTop>

## What If We Only Made Controlled Components?

- API surface area significantly reduced
- Testing becomes easier
- Prop mismatch errors less likely

</Slide>

---

<Slide isTop>

## What About State?

</Slide>

---

<Slide isTop>

## What About State?

- Create encapsulated custom hooks

</Slide>

---

<Slide isTop>

## What About State?

- Create encapsulated custom hooks
- Take state out of components

</Slide>

---

<Slide isTop>

## What About State?

- Create encapsulated custom hooks
- Take state out of components
- Ship separate components and state hooks

</Slide>

---

<Slide isTop>

## What About State?

- Create encapsulated custom hooks
- Take state out of components
- Ship separate components and state hooks
- Tests scoped to props/state

</Slide>

---

<Slide isTop>

## What About State?

- Create encapsulated custom hooks
- Take state out of components
- Ship separate components and state hooks
- Tests scoped to props/state
- Declarative instead of imperative

</Slide>

---

<Slide>

# Back To the Code

## Prove it...

</Slide>

---

Right where we left it

---

```jsx src/Tag.js focus=6:9
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [state, setState] = useState({
    tags: ['Rocket', 'Pogo', 'Franco'],
    newLabel: '',
  });

  function addTag(name) {
    setState({ tags: [...state.tags, name], newLabel: '' });
  }

  function removeTagAtIndex(index) {
    setState({ ...state, tags: omitIndexes([index], state.tags) });
  }

  function moveTagForward(index) {
    setState({ ...state, tags: move(index, index - 1, state.tags) });
  }

  function moveTagBackward(index) {
    setState({ ...state, tags: move(index, index + 1, state.tags) });
  }

  const handleInputChange = (event) => {
    setState({ ...state, newLabel: event.target.value });
  };

  const handleSubmit = (event) => {
    addTag(state.newLabel);
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={state.newLabel}
          onChange={handleInputChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {state.tags?.length &&
          state.tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={state.tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

<Slide isSmall>

## Custom Hook

Remember our class component?

</Slide>

---

```jsx src/Tag.js focus=6,7,10,14,18,22,26,30,31
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [tags, setTags] = useState(['Arsenal']);
  const [newLabel, setNewLabel] = useState('');

  function addTag(name) {
    setTags([...tags, name]);
  }

  function removeTagAtIndex(index) {
    setTags(omitIndexes([index], tags));
  }

  function moveTagForward(index) {
    setTags(move(index, index - 1, tags));
  }

  function moveTagBackward(index) {
    setTags(move(index, index + 1, tags));
  }

  const handleInputChange = (event) => {
    setNewLabel(event.target.value);
  };

  const handleSubmit = (event) => {
    addTag?.(newLabel);
    setNewLabel('');
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={newLabel}
          onChange={handleInputChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {tags?.length &&
          tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

<Slide isSmall>

## Custom Hook

Remember our class component?

</Slide>

---

<Slide isSmall>

## Custom Hook

Remember our class component?

- State no longer needs to be singular object

</Slide>

---

<Slide isSmall>

## Custom Hook

Remember our class component?

- State no longer needs to be singular object
- Improved semantics

</Slide>

---

```jsx src/Tag.js focus=6,9:23
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [tags, setTags] = useState(['Arsenal']);
  const [newLabel, setNewLabel] = useState('');

  function addTag(name) {
    setTags([...tags, name]);
  }

  function removeTagAtIndex(index) {
    setTags(omitIndexes([index], tags));
  }

  function moveTagForward(index) {
    setTags(move(index, index - 1, tags));
  }

  function moveTagBackward(index) {
    setTags(move(index, index + 1, tags));
  }

  const handleInputChange = (event) => {
    setNewLabel(event.target.value);
  };

  const handleSubmit = (event) => {
    addTag?.(newLabel);
    setNewLabel('');
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={newLabel}
          onChange={handleInputChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {tags?.length &&
          tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

<Slide isSmall>

## Custom Hook

Remember our class component?

- State no longer needs to be singular object
- Improved semantics

</Slide>

---

```jsx src/useTagState.js
import { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';

export default function useTabState() {
  const [tags, setTags] = useState(['Arsenal']);

  function addTag(name) {
    setTags([...tags, name]);
  }

  function removeTagAtIndex(index) {
    setTags(omitIndexes([index], tags));
  }

  function moveTagForward(index) {
    setTags(move(index, index - 1, tags));
  }

  function moveTagBackward(index) {
    setTags(move(index, index + 1, tags));
  }
}
```

<Slide isSmall>

## Custom Hook

Remember our class component?

- State no longer needs to be singular object
- Improved semantics

</Slide>

---

<Slide isSmall>

## Custom Hook

Remember our class component?

- State no longer needs to be singular object
- Improved semantics
- Encapsulate state logic

</Slide>

---

```jsx src/useTagState.js focus=23:29
import { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';

export default function useTabState({ initialTags } = {}) {
  const [tags, setTags] = useState(initialTags || []);

  function addTag(name) {
    setTags([...tags, name]);
  }

  function removeTagAtIndex(index) {
    setTags(omitIndexes([index], tags));
  }

  function moveTagForward(index) {
    setTags(move(index, index - 1, tags));
  }

  function moveTagBackward(index) {
    setTags(move(index, index + 1, tags));
  }

  return {
    addTag,
    moveTagBackward,
    moveTagForward,
    removeTagAtIndex,
    tags,
  };
}
```

<Slide isSmall>

## Custom Hook

Remember our class component?

- State no longer needs to be singular object
- Improved semantics
- Encapsulate state logic

</Slide>

---

<Slide isSmall>

## Custom Hook

Remember our class component?

- State no longer needs to be singular object
- Improved semantics
- Encapsulate state logic
- Return state and setter methods

</Slide>

---

```jsx src/useTagState.js focus=5[16:22]
import { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';

export default function useTabState({ initialTags } = {}) {
  const [tags, setTags] = useState(initialTags || []);

  function addTag(name) {
    setTags([...tags, name]);
  }

  function removeTagAtIndex(index) {
    setTags(omitIndexes([index], tags));
  }

  function moveTagForward(index) {
    setTags(move(index, index - 1, tags));
  }

  function moveTagBackward(index) {
    setTags(move(index, index + 1, tags));
  }

  return {
    addTag,
    moveTagBackward,
    moveTagForward,
    removeTagAtIndex,
    tags,
  };
}
```

<Slide isSmall>

## Custom Hook

Remember our class component?

- State no longer needs to be singular object
- Improved semantics
- Encapsulate state logic
- Return state and setter methods

</Slide>

---

<Slide isSmall>

## Custom Hook

Remember our class component?

- State no longer needs to be singular object
- Improved semantics
- Encapsulate state logic
- Return state and setter methods
- Do NOT return state setter directly ‚ö†Ô∏è

</Slide>

---

```jsx src/Tag.js focus=6,9:23
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [tags, setTags] = useState(['Arsenal']);
  const [newLabel, setNewLabel] = useState('');

  function addTag(name) {
    setTags([...tags, name]);
  }

  function removeTagAtIndex(index) {
    setTags(omitIndexes([index], tags));
  }

  function moveTagForward(index) {
    setTags(move(index, index - 1, tags));
  }

  function moveTagBackward(index) {
    setTags(move(index, index + 1, tags));
  }

  const handleInputChange = (event) => {
    setNewLabel(event.target.value);
  };

  const handleSubmit = (event) => {
    addTag?.(newLabel);
    setNewLabel('');
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={newLabel}
          onChange={handleInputChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {tags?.length &&
          tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

<Slide isSmall>

## Custom Hook

Remember our class component?

- State no longer needs to be singular object
- Improved semantics
- Encapsulate state logic
- Return state and setter methods
- Do NOT return state setter directly ‚ö†Ô∏è

</Slide>

---

```jsx src/Tag.js focus=3,7:8
import React, { useState } from 'react';
import { AnimatePresence, m } from 'framer-motion';
import useTagState from './useTagState';

export default function Tag() {
  const [newLabel, setNewLabel] = useState('');
  const { addTag, moveTagBackward, moveTagForward, removeTagAtIndex, tags } =
    useTagState();

  const handleInputChange = (event) => {
    setNewLabel(event.target.value);
  };

  const handleSubmit = (event) => {
    addTag?.(newLabel);
    setNewLabel('');
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={newLabel}
          onChange={handleInputChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {tags?.length &&
          tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

<Slide isSmall>

## Custom Hook

Remember our class component?

- State no longer needs to be singular object
- Improved semantics
- Encapsulate state logic
- Return state and setter methods
- Do NOT return state setter directly ‚ö†Ô∏è

</Slide>

---

<Slide isSmall>

## Custom Hook

Remember our class component?

- State no longer needs to be singular object
- Improved semantics
- Encapsulate state logic
- Return state and setter methods
- Do NOT return state setter directly ‚ö†Ô∏è
- Replace with custom hook

</Slide>

---

<Slide isSmall>

## Custom Hook

Remember our class component?

- State no longer needs to be singular object
- Improved semantics
- Encapsulate state logic
- Return state and setter methods
- Do NOT return state setter directly ‚ö†Ô∏è
- Replace with custom hook

Let's take a look...

</Slide>

---

```jsx src/Tag.js
import React, { useState } from 'react';
import { AnimatePresence, m } from 'framer-motion';
import useTagState from './useTagState';

export default function Tag() {
  const [newLabel, setNewLabel] = useState('');
  const { addTag, moveTagBackward, moveTagForward, removeTagAtIndex, tags } =
    useTagState();

  const handleInputChange = (event) => {
    setNewLabel(event.target.value);
  };

  const handleSubmit = (event) => {
    addTag?.(newLabel);
    setNewLabel('');
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={newLabel}
          onChange={handleInputChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {tags?.length &&
          tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

---

```jsx src/useTagState.js
import { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';

export default function useTabState({ initialTags } = {}) {
  const [tags, setTags] = useState(initialTags || []);

  function addTag(name) {
    setTags([...tags, name]);
  }

  function removeTagAtIndex(index) {
    setTags(omitIndexes([index], tags));
  }

  function moveTagForward(index) {
    setTags(move(index, index - 1, tags));
  }

  function moveTagBackward(index) {
    setTags(move(index, index + 1, tags));
  }

  return {
    addTag,
    moveTagBackward,
    moveTagForward,
    removeTagAtIndex,
    tags,
  };
}
```

---

<Slide isSmall>

## Hoist State

Make our custom hook portable

</Slide>

---

```jsx src/App.js
import Tag from './Tag';

export default function App() {
  return <Tag />;
}
```

---

```jsx src/App.js focus=2,5
import Tag from './Tag';
import useTagState from './useTagState';

export default function App() {
  const tagState = useTagState({ initialTags: ['foo', 'bar'] });

  return <Tag />;
}
```

---

```jsx src/App.js focus=7[15:27]
import Tag from './Tag';
import useTagState from './useTagState';

export default function App() {
  const tagState = useTagState({ initialTags: ['foo', 'bar'] });

  return <Tag {...tagState} />;
}
```

---

```jsx src/App.js
import Tag from './Tag';
import useTagState from './useTagState';

export default function App() {
  const tagStateA = useTagState({ initialTags: ['foo', 'bar'] });
  const tagStateB = useTagState({ initialTags: ['baz', 'bat'] });

  return (
    <>
      <Tag {...tagStateA} />
      <Tag {...tagStateB} />
    </>
  );
}
```

---

```jsx src/Tag.js focus=3,7:8
import React, { useState } from 'react';
import { AnimatePresence, m } from 'framer-motion';
import useTagState from './useTagState';

export default function Tag() {
  const [newLabel, setNewLabel] = useState('');
  const { addTag, moveTagBackward, moveTagForward, removeTagAtIndex, tags } =
    useTagState();

  const handleInputChange = (event) => {
    setNewLabel(event.target.value);
  };

  const handleSubmit = (event) => {
    addTag?.(newLabel);
    setNewLabel('');
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={newLabel}
          onChange={handleInputChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {tags?.length &&
          tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

---

```jsx src/Tag.js
import React, { useState } from 'react';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag({
  addTag,
  moveTagBackward,
  moveTagForward,
  removeTagAtIndex,
  tags,
} = {}) {
  const [newLabel, setNewLabel] = useState('');

  const handleInputChange = (event) => {
    setNewLabel(event.target.value);
  };

  const handleSubmit = (event) => {
    addTag?.(newLabel);
    setNewLabel('');
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={newLabel}
          onChange={handleInputChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {tags?.map((name, i) => (
          <m.span
            key={i}
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
          >
            {name}
            <button disabled={i === 0} onClick={() => moveTagForward(i)}>
              ‚Äπ
            </button>
            <button
              disabled={tags?.length === i + 1}
              onClick={() => moveTagBackward(i)}
            >
              ‚Ä∫
            </button>
            <button onClick={() => removeTagAtIndex(i)}>‚úï</button>
          </m.span>
        ))}
      </AnimatePresence>
    </>
  );
}
```

---

<Slide>

## Examples

Let's see it in action

</Slide>

---

```jsx src/App.js
import Tag from './Tag';
import useTagState from './useTagState';

export default function App() {
  const tagStateA = useTagState({ initialTags: ['foo', 'bar'] });
  const tagStateB = useTagState({ initialTags: ['baz', 'bat'] });

  return (
    <>
      <Tag {...tagStateA} />
      <Tag {...tagStateB} />
    </>
  );
}
```

---

```jsx src/App.js focus=10,11
import Tag from './Tag';
import useTagState from './useTagState';

export default function App() {
  const tagStateA = useTagState({ initialTags: ['foo', 'bar'] });
  const tagStateB = useTagState({ initialTags: ['baz', 'bat'] });

  return (
    <>
      <h2>No State</h2>
      <Tag />
      <Tag {...tagStateB} />
    </>
  );
}
```

---

```jsx src/App.js focus=8:13,21,22
import Tag from './Tag';
import useTagState from './useTagState';

export default function App() {
  const tagStateA = useTagState({ initialTags: ['foo', 'bar'] });
  const tagStateB = useTagState({ initialTags: ['baz', 'bat'] });

  // External implementation details
  const { removeTagAtIndex, ...tagStateC } = useTagState();
  function trackDelete(index) {
    removeTagAtIndex(index);
    alert(`Deleted ${tagStateC.tags[index]} at index ${index}`);
  }

  return (
    <>
      <h2>No State</h2>
      <Tag />
      <Tag {...tagStateB} />

      <h2>Insert Logic</h2>
      <Tag {...tagStateC} removeTagAtIndex={trackDelete} />
    </>
  );
}
```

---

```jsx src/App.js focus=15:18,29:33
import Tag from './Tag';
import useTagState from './useTagState';

export default function App() {
  const tagStateA = useTagState({ initialTags: ['foo', 'bar'] });
  const tagStateB = useTagState({ initialTags: ['baz', 'bat'] });

  // External implementation details
  const { removeTagAtIndex, ...tagStateC } = useTagState();
  function trackDelete(index) {
    removeTagAtIndex(index);
    alert(`Deleted ${tagStateC.tags[index]} at index ${index}`);
  }

  // Place state where it is needed in the React tree
  const tagStateD = useTagState();
  const { tags } = tagStateD;
  const myUrlParams = new URLSearchParams({ tags });

  return (
    <>
      <h2>No State</h2>
      <Tag />
      <Tag {...tagStateB} />

      <h2>Insert Logic</h2>
      <Tag {...tagStateC} removeTagAtIndex={trackDelete} />

      <h2>Hoist State</h2>
      <Tag {...tagStateD} />
      <pre>
        <code>{myUrlParams.toString()}</code>
      </pre>
    </>
  );
}
```

---

```jsx src/App.js focus=20:25,42:46
import Tag from './Tag';
import useTagState from './useTagState';

export default function App() {
  const tagStateA = useTagState({ initialTags: ['foo', 'bar'] });
  const tagStateB = useTagState({ initialTags: ['baz', 'bat'] });

  // External implementation details
  const { removeTagAtIndex, ...tagStateC } = useTagState();
  function trackDelete(index) {
    removeTagAtIndex(index);
    alert(`Deleted ${tagStateC.tags[index]} at index ${index}`);
  }

  // Place state where it is needed in the React tree
  const tagStateD = useTagState();
  const { tags } = tagStateD;
  const myUrlParams = new URLSearchParams({ tags });

  // Control Externally
  const tagStateE = useTagState();
  const handleCreateTag = (event) => {
    const { addTag } = tagStateE;
    addTag(event.target.textContent);
  };

  return (
    <>
      <h2>No State</h2>
      <Tag />
      <Tag {...tagStateB} />

      <h2>Insert Logic</h2>
      <Tag {...tagStateC} removeTagAtIndex={trackDelete} />

      <h2>Hoist State</h2>
      <Tag {...tagStateD} />
      <pre>
        <code>{myUrlParams.toString()}</code>
      </pre>

      <h2>External Control</h2>
      <button onClick={handleCreateTag}>Rocket</button>
      <button onClick={handleCreateTag}>Franco</button>
      <button onClick={handleCreateTag}>Pogo</button>
      <Tag {...tagStateE} />
    </>
  );
}
```

---

<Slide isTop>

## Benefit Recap

</Slide>

---

<Slide isTop>

## Benefit Recap

- Encapsulated

</Slide>

---

<Slide isTop>

## Benefit Recap

- Encapsulated
- Declarative

</Slide>

---

<Slide isTop>

## Benefit Recap

- Encapsulated
- Declarative
- Composable and reusable

</Slide>

---

<Slide isTop>

## Benefit Recap

- Encapsulated
- Declarative
- Composable and reusable
- Separate unit tests

</Slide>

---

<Slide isTop>

## Benefit Recap

- Encapsulated
- Declarative
- Composable and reusable
- Separate unit tests
- More stability

</Slide>

---

<Slide>

# Moving Forward

## What do we do with this information?

</Slide>

---

<Slide isTop>

## Start Using Portable State Hooks!

</Slide>

---

<Slide isTop>

## Start Using Portable State Hooks!

- Find opportunities with new components

</Slide>

---

<Slide isTop>

## Start Using Portable State Hooks!

- Find opportunities with new components
- Challenge yourself/team to compare APIs

</Slide>

---

<Slide isTop>

## Start Using Portable State Hooks!

- Find opportunities with new components
- Challenge yourself/team to compare APIs
- Learn from prior art (Reakit, Ariakit, etc.)

</Slide>

---

<Slide isTop>

## Start Using Portable State Hooks!

- Find opportunities with new components
- Challenge yourself/team to compare APIs
- Learn from prior art (Reakit, Ariakit, etc.)
- Talk to colleagues who have used these patterns (Slack: @bje)

</Slide>

---

<Slide columns={2}>

## Appendix

Built With, Inspired By, and Supplemental Resources

- [Code Hike](https://github.com/code-hike/codehike)
- [Framer Motion](https://github.com/framer/motion)
- [MDX](https://github.com/mdx-js/mdx)
- [Next.js](https://github.com/vercel/next.js)
- [NX](https://github.com/nrwl/nx)
- [React Flow](https://github.com/wbkd/react-flow)
- [water.css](https://github.com/kognise/water.css)
- [Reakit](https://reakit.io/)
- [Ariakit](https://github.com/ariakit/ariakit)

Source and Slides

- [https://portable-hooks.bje.co](https://portable-hooks.bje.co)
- [GitHub](https://github.com/brianespinosa/portable-hooks)

</Slide>

---

<Slide columns={2}>

# Thank You!

## Questions?

</Slide>

</CH.Slideshow>
