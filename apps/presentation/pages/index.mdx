import Slide from '../components/slide';
import Logo from '../components/logo';
import Drawing from '../components/drawing';
import { setQueryParamIndex, getQueryParamIndex } from '../utils';
import details from '../details.json';

<CH.Slideshow
  preset="https://codesandbox.io/s/portable-hooks-l9xy3z"
  code={{minZoom: 1.75}}
  autoFocus
  start={getQueryParamIndex()}
  onChange={setQueryParamIndex}
>

```jsx src/Tag.js
import React from 'react';

class Tags extends React.Component {
  render() {
    return <h1>Tags</h1>;
  }
}

export default Tags;
```

<Slide hideFooter>

<Logo />

# {details.title}

## {details.author} | {details.authorDepartment}

</Slide>

0

---

<Slide>

## Hello!

My name is Brian Espinosa and I am the Director of Engineering for Momentive Analysis.

- Joined Momentive March 2022
- Live in Tacoma, WA
- Using React since v0.12.0

</Slide>

1

---

<Slide>

# Getting Started

## Before we go anywhere... where are we?

</Slide>

2

---

<Slide isTop>

## Do These Challenges Sound Familar?

</Slide>

3

---

<Slide isTop>

## Do These Challenges Sound Familar?

- Need to access internal component state or methods

</Slide>

4

---

<Slide isTop>

## Do These Challenges Sound Familar?

- Need to access internal component state or methods
- Growing prop complexity to support competing product use cases

</Slide>

5

---

<Slide isTop>

## Do These Challenges Sound Familar?

- Need to access internal component state or methods
- Growing prop complexity to support competing product use cases
- Massive unit tests that must cover prop, state, and UX functionality

</Slide>

6

---

<Slide isTop>

## Do These Challenges Sound Familar?

- Need to access internal component state or methods
- Growing prop complexity to support competing product use cases
- Massive unit tests that must cover prop, state, and UX functionality
- Difficulty composing or reusing components across products with diverging use cases

</Slide>

7

---

<Slide>

## Why Is This a Problem?

Significant impact on productivity, scale, and cost. üí∏ üí£ üòû

</Slide>

- Multiple component implementations
- Competing implementation details
- Less stability at scale
- Work is slower in complex components
- This is not fun work! üòû

---

<Slide>

## Let's Fix This!

All of these problems can be significantly reduced or eliminated completely with portable state hooks. üôå

</Slide>

- Patterns for safely sharing component state
- Push implementation details into applications
- Focus on reusability
- Fuctional programming principles

---

<Slide>

## Example Component

Allows us to add, move, reorder, and <br/> remove tags

<img src="tags.png" alt="Example tag component" style={{ maxWidth: '50%' }} />

</Slide>

---

<Slide>

## Example Component

Allows us to add, move, reorder, and <br/> remove dogs

<img
  src="degs.jpeg"
  alt=""
  style={{
    maxWidth: '30%',
    position: 'absolute',
    right: 0,
    bottom: '4vw',
    borderRadius: '100%',
  }}
/>

<img src="tags.png" alt="Example tag component" style={{ maxWidth: '50%' }} />

</Slide>

---

<Slide>

# Code Time

## Where did these problems come from?

</Slide>

---

<Slide>

## Class Components

Thanks for coming to the talk! üëã

</Slide>

---

```jsx src/Tag.js
import React from 'react';

class Tags extends React.Component {
  render() {
    return <h1>Tags</h1>;
  }
}

export default Tags;
```

<Slide isSmall>

## Class Components

Relax... class components are okay (sometimes)

<Drawing />

</Slide>

---

<Slide isSmall>

## Class Components

<Drawing />

</Slide>

---

```jsx src/Tag.js focus=4
import React from 'react';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  render() {
    return <h1>Tags</h1>;
  }
}

export default Tags;
```

<Slide isSmall>

## Class Components

<Drawing />

</Slide>

---

<Slide isSmall>

## Class Components

- State belongs to class

<Drawing />

</Slide>

---

<Slide isSmall>

## Class Components

- State belongs to class
- Complex, combined state object

<Drawing />

</Slide>

---

```jsx src/Tag.js focus=7:33
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  render() {
    return <h1>Tags</h1>;
  }
}

export default Tags;
```

<Slide isSmall>

## Class Components

- State belongs to class
- Complex, combined state object

<Drawing />

</Slide>

---

<Slide isSmall>

## Class Components

- State belongs to class
- Complex, combined state object
- Methods for setting state üôè

<Drawing />

</Slide>

---

```jsx src/Tag.js focus=35:42
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleLabelChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return <h1>Tags</h1>;
  }
}

export default Tags;
```

<Slide isSmall>

## Class Components

- State belongs to class
- Complex, combined state object
- Methods for setting state üôè

<Drawing />

</Slide>

---

<Slide isSmall>

## Class Components

- State belongs to class
- Complex, combined state object
- Methods for setting state üôè
- Event handlers

<Drawing />

</Slide>

- Render function
- Unit tests have to cover everything
- Hoisting state -> controlled components

---

```jsx src/Tag.js focus=44:46
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleLabelChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return <h1>Tags</h1>;
  }
}

export default Tags;
```

---

```jsx src/Tag.js focus=46:55
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleLabelChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return (
      <>
        <form onSubmit={this.handleSubmit}>
          <input
            type="text"
            value={this.state.newLabel}
            onChange={this.handleLabelChange}
            placeholder="Add a tag..."
          />
        </form>
      </>
    );
  }
}

export default Tags;
```

---

```jsx src/Tag.js focus=56:77
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleLabelChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return (
      <>
        <form onSubmit={this.handleSubmit}>
          <input
            type="text"
            value={this.state.newLabel}
            onChange={this.handleLabelChange}
            placeholder="Add a tag..."
          />
        </form>
        <AnimatePresence>
          {this.state.tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={this.state.tags?.length === i + 1}
                onClick={() => this.moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => this.removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
        </AnimatePresence>
      </>
    );
  }
}

export default Tags;
```

---

```jsx src/Tag.js
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleLabelChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return (
      <>
        <form onSubmit={this.handleSubmit}>
          <input
            type="text"
            value={this.state.newLabel}
            onChange={this.handleLabelChange}
            placeholder="Add a tag..."
          />
        </form>
        <AnimatePresence>
          {this.state.tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={this.state.tags?.length === i + 1}
                onClick={() => this.moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => this.removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
        </AnimatePresence>
      </>
    );
  }
}

export default Tags;
```

---

<Slide>

## Quick Refactor

Keep our class state/methods in mind üëÄ

</Slide>

---

```jsx src/Tag.js
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleLabelChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return (
      <>
        <form onSubmit={this.handleSubmit}>
          <input
            type="text"
            value={this.state.newLabel}
            onChange={this.handleLabelChange}
            placeholder="Add a tag..."
          />
        </form>
        <AnimatePresence>
          {this.state.tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={this.state.tags?.length === i + 1}
                onClick={() => this.moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => this.removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
        </AnimatePresence>
      </>
    );
  }
}

export default Tags;
```

<Slide isSmall>

## Function Component

- State hook belongs to render
- Utility setting functions
- Event handlers

</Slide>

---

```jsx src/Tag.js focus=6
import React from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

class Tags extends React.Component {
  state = { tags: [], newLabel: '' };

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleLabelChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return (
      <>
        <form onSubmit={this.handleSubmit}>
          <input
            type="text"
            value={this.state.newLabel}
            onChange={this.handleLabelChange}
            placeholder="Add a tag..."
          />
        </form>
        <AnimatePresence>
          {this.state.tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={this.state.tags?.length === i + 1}
                onClick={() => this.moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => this.removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
        </AnimatePresence>
      </>
    );
  }
}

export default Tags;
```

<Slide isSmall>

## Function Component

- State hook belongs to render
- Utility setting functions
- Event handlers

</Slide>

---

```jsx src/Tag.js focus=1,6:9
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

class Tags extends React.Component {
  const [state, setState] = useState({
    tags: ['Rocket', 'Pogo', 'Franco'],
    newLabel: '',
  });

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleLabelChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  render() {
    return (
      <>
        <form onSubmit={this.handleSubmit}>
          <input
            type="text"
            value={this.state.newLabel}
            onChange={this.handleLabelChange}
            placeholder="Add a tag..."
          />
        </form>
        <AnimatePresence>
          {this.state.tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={this.state.tags?.length === i + 1}
                onClick={() => this.moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => this.removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
        </AnimatePresence>
      </>
    );
  }
}

export default Tags;
```

<Slide isSmall>

## Function Component

- State hook belongs to render
- Utility setting functions
- Event handlers

</Slide>

---

```jsx src/Tag.js focus=5
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [state, setState] = useState({
    tags: ['Rocket', 'Pogo', 'Franco'],
    newLabel: '',
  });

  addTag(name) {
    this.setState({
      tags: [...this.state.tags, name],
      newLabel: '',
    });
  }

  removeTagAtIndex(index) {
    this.setState({
      ...this.state,
      tags: omitIndexes([index], this.state.tags),
    });
  }

  moveTagForward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index - 1, this.state.tags),
    });
  }

  moveTagBackward(index) {
    this.setState({
      ...this.state,
      tags: move(index, index + 1, this.state.tags),
    });
  }

  handleLabelChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={this.handleSubmit}>
        <input
          type="text"
          value={this.state.newLabel}
          onChange={this.handleLabelChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {this.state.tags.map((name, i) => (
          <m.span
            key={i}
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
          >
            {name}
            <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
              ‚Äπ
            </button>
            <button
              disabled={this.state.tags?.length === i + 1}
              onClick={() => this.moveTagBackward(i)}
            >
              ‚Ä∫
            </button>
            <button onClick={() => this.removeTagAtIndex(i)}>‚úï</button>
          </m.span>
        ))}
      </AnimatePresence>
    </>
  );
}
```

<Slide isSmall>

## Function Component

- State hook belongs to render
- Utility setting functions
- Event handlers

</Slide>

---

```jsx src/Tag.js focus=11:25
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [state, setState] = useState({
    tags: ['Rocket', 'Pogo', 'Franco'],
    newLabel: '',
  });

  function addTag(name) {
    setState({ tags: [...state.tags, name], newLabel: '' });
  }

  function removeTagAtIndex(index) {
    setState({ ...state, tags: omitIndexes([index], state.tags) });
  }

  function moveTagForward(index) {
    setState({ ...state, tags: move(index, index - 1, state.tags) });
  }

  function moveTagBackward(index) {
    setState({ ...state, tags: move(index, index + 1, state.tags) });
  }

  handleLabelChange = (event) => {
    this.setState({ ...this.state, newLabel: event.target.value });
  };

  handleSubmit = (event) => {
    this.addTag(this.state.newLabel);
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={this.handleSubmit}>
        <input
          type="text"
          value={this.state.newLabel}
          onChange={this.handleLabelChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {this.state.tags.map((name, i) => (
          <m.span
            key={i}
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
          >
            {name}
            <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
              ‚Äπ
            </button>
            <button
              disabled={this.state.tags?.length === i + 1}
              onClick={() => this.moveTagBackward(i)}
            >
              ‚Ä∫
            </button>
            <button onClick={() => this.removeTagAtIndex(i)}>‚úï</button>
          </m.span>
        ))}
      </AnimatePresence>
    </>
  );
}
```

<Slide isSmall>

## Function Component

- State hook belongs to render
- Utility setting functions
- Event handlers

</Slide>

---

```jsx src/Tag.js focus=27:34
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [state, setState] = useState({
    tags: ['Rocket', 'Pogo', 'Franco'],
    newLabel: '',
  });

  function addTag(name) {
    setState({ tags: [...state.tags, name], newLabel: '' });
  }

  function removeTagAtIndex(index) {
    setState({ ...state, tags: omitIndexes([index], state.tags) });
  }

  function moveTagForward(index) {
    setState({ ...state, tags: move(index, index - 1, state.tags) });
  }

  function moveTagBackward(index) {
    setState({ ...state, tags: move(index, index + 1, state.tags) });
  }

  const handleLabelChange = (event) => {
    setState({ ...state, newLabel: event.target.value });
  };

  const handleSubmit = (event) => {
    addTag(state.newLabel);
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={this.handleSubmit}>
        <input
          type="text"
          value={this.state.newLabel}
          onChange={this.handleLabelChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {this.state.tags.map((name, i) => (
          <m.span
            key={i}
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
          >
            {name}
            <button disabled={i === 0} onClick={() => this.moveTagForward(i)}>
              ‚Äπ
            </button>
            <button
              disabled={this.state.tags?.length === i + 1}
              onClick={() => this.moveTagBackward(i)}
            >
              ‚Ä∫
            </button>
            <button onClick={() => this.removeTagAtIndex(i)}>‚úï</button>
          </m.span>
        ))}
      </AnimatePresence>
    </>
  );
}
```

<Slide isSmall>

## Function Component

- State hook belongs to render
- Utility setting functions
- Event handlers

</Slide>

---

```jsx src/Tag.js focus=38:68
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [state, setState] = useState({
    tags: ['Rocket', 'Pogo', 'Franco'],
    newLabel: '',
  });

  function addTag(name) {
    setState({ tags: [...state.tags, name], newLabel: '' });
  }

  function removeTagAtIndex(index) {
    setState({ ...state, tags: omitIndexes([index], state.tags) });
  }

  function moveTagForward(index) {
    setState({ ...state, tags: move(index, index - 1, state.tags) });
  }

  function moveTagBackward(index) {
    setState({ ...state, tags: move(index, index + 1, state.tags) });
  }

  const handleLabelChange = (event) => {
    setState({ ...state, newLabel: event.target.value });
  };

  const handleSubmit = (event) => {
    addTag(state.newLabel);
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={state.newLabel}
          onChange={handleLabelChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {state.tags?.length &&
          state.tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={state.tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

<Slide isSmall>

## Function Component

- State hook belongs to render
- Utility setting functions
- Event handlers

</Slide>

---

```jsx src/Tag.js
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [state, setState] = useState({
    tags: ['Rocket', 'Pogo', 'Franco'],
    newLabel: '',
  });

  function addTag(name) {
    setState({ tags: [...state.tags, name], newLabel: '' });
  }

  function removeTagAtIndex(index) {
    setState({ ...state, tags: omitIndexes([index], state.tags) });
  }

  function moveTagForward(index) {
    setState({ ...state, tags: move(index, index - 1, state.tags) });
  }

  function moveTagBackward(index) {
    setState({ ...state, tags: move(index, index + 1, state.tags) });
  }

  const handleLabelChange = (event) => {
    setState({ ...state, newLabel: event.target.value });
  };

  const handleSubmit = (event) => {
    addTag(state.newLabel);
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={state.newLabel}
          onChange={handleLabelChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {state.tags?.length &&
          state.tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={state.tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

---

<Slide isSmall>

## Most Common Function Component

- Uncontrolled with internal state and some props
- Prop surface area continues to grow as we need to give access inside the component
- Logic becomes increasingly complex once we have a üî• Propocalypse‚Ñ¢
- Have to balance functionality both controlled and uncontrolled component styles
- Begin to rely on anti-patterns passing state back up the tree

</Slide>

---

<Slide isSmall>

## What If We Only Made Controlled Components?

- Component logic becomes more simple
- Chances for a Propocalypse‚Ñ¢ are reduced
- But... how do we still help developers do their jobs?

</Slide>

---

```jsx src/Tag.js focus=6:9
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [state, setState] = useState({
    tags: ['Rocket', 'Pogo', 'Franco'],
    newLabel: '',
  });

  function addTag(name) {
    setState({ tags: [...state.tags, name], newLabel: '' });
  }

  function removeTagAtIndex(index) {
    setState({ ...state, tags: omitIndexes([index], state.tags) });
  }

  function moveTagForward(index) {
    setState({ ...state, tags: move(index, index - 1, state.tags) });
  }

  function moveTagBackward(index) {
    setState({ ...state, tags: move(index, index + 1, state.tags) });
  }

  const handleLabelChange = (event) => {
    setState({ ...state, newLabel: event.target.value });
  };

  const handleSubmit = (event) => {
    addTag(state.newLabel);
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={state.newLabel}
          onChange={handleLabelChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {state.tags?.length &&
          state.tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={state.tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

---

```jsx src/Tag.js
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [tags, setTags] = useState(['Arsenal']);
  const [newLabel, setNewLabel] = useState('');

  function addTag(name) {
    setTags([...tags, name]);
  }

  function removeTagAtIndex(index) {
    setTags(omitIndexes([index], tags));
  }

  function moveTagForward(index) {
    setTags(move(index, index - 1, tags));
  }

  function moveTagBackward(index) {
    setTags(move(index, index + 1, tags));
  }

  const handleLabelChange = (event) => {
    setNewLabel(event.target.value);
  };

  const handleSubmit = (event) => {
    addTag?.(newLabel);
    setNewLabel('');
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={newLabel}
          onChange={handleLabelChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {tags?.length &&
          tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

---

```jsx src/Tag.js focus=6,9:23
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [tags, setTags] = useState(['Arsenal']);
  const [newLabel, setNewLabel] = useState('');

  function addTag(name) {
    setTags([...tags, name]);
  }

  function removeTagAtIndex(index) {
    setTags(omitIndexes([index], tags));
  }

  function moveTagForward(index) {
    setTags(move(index, index - 1, tags));
  }

  function moveTagBackward(index) {
    setTags(move(index, index + 1, tags));
  }

  const handleLabelChange = (event) => {
    setNewLabel(event.target.value);
  };

  const handleSubmit = (event) => {
    addTag?.(newLabel);
    setNewLabel('');
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={newLabel}
          onChange={handleLabelChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {tags?.length &&
          tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

---

```jsx src/useTagState.js
import { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';

export default function useTabState() {
  const [tags, setTags] = useState(['Arsenal']);

  function addTag(name) {
    setTags([...tags, name]);
  }

  function removeTagAtIndex(index) {
    setTags(omitIndexes([index], tags));
  }

  function moveTagForward(index) {
    setTags(move(index, index - 1, tags));
  }

  function moveTagBackward(index) {
    setTags(move(index, index + 1, tags));
  }
}
```

---

```jsx src/useTagState.js focus=5[16:22],23:29
import { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';

export default function useTabState({ initialTags } = {}) {
  const [tags, setTags] = useState(initialTags || []);

  function addTag(name) {
    setTags([...tags, name]);
  }

  function removeTagAtIndex(index) {
    setTags(omitIndexes([index], tags));
  }

  function moveTagForward(index) {
    setTags(move(index, index - 1, tags));
  }

  function moveTagBackward(index) {
    setTags(move(index, index + 1, tags));
  }

  return {
    addTag,
    moveTagBackward,
    moveTagForward,
    removeTagAtIndex,
    tags,
  };
}
```

---

```jsx src/Tag.js focus=6,9:23
import React, { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag() {
  const [tags, setTags] = useState(['Arsenal']);
  const [newLabel, setNewLabel] = useState('');

  function addTag(name) {
    setTags([...tags, name]);
  }

  function removeTagAtIndex(index) {
    setTags(omitIndexes([index], tags));
  }

  function moveTagForward(index) {
    setTags(move(index, index - 1, tags));
  }

  function moveTagBackward(index) {
    setTags(move(index, index + 1, tags));
  }

  const handleLabelChange = (event) => {
    setNewLabel(event.target.value);
  };

  const handleSubmit = (event) => {
    addTag?.(newLabel);
    setNewLabel('');
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={newLabel}
          onChange={handleLabelChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {tags?.length &&
          tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

---

```jsx src/Tag.js focus=3,7:8
import React, { useState } from 'react';
import { AnimatePresence, m } from 'framer-motion';
import useTagState from './useTagState';

export default function Tag() {
  const [newLabel, setNewLabel] = useState('');
  const { addTag, moveTagBackward, moveTagForward, removeTagAtIndex, tags } =
    useTagState();

  const handleLabelChange = (event) => {
    setNewLabel(event.target.value);
  };

  const handleSubmit = (event) => {
    addTag?.(newLabel);
    setNewLabel('');
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={newLabel}
          onChange={handleLabelChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {tags?.length &&
          tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

---

```jsx src/Tag.js
import React, { useState } from 'react';
import { AnimatePresence, m } from 'framer-motion';
import useTagState from './useTagState';

export default function Tag() {
  const [newLabel, setNewLabel] = useState('');
  const { addTag, moveTagBackward, moveTagForward, removeTagAtIndex, tags } =
    useTagState();

  const handleLabelChange = (event) => {
    setNewLabel(event.target.value);
  };

  const handleSubmit = (event) => {
    addTag?.(newLabel);
    setNewLabel('');
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={newLabel}
          onChange={handleLabelChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {tags?.length &&
          tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

---

```jsx src/useTagState.js
import { useState } from 'react';
import { omitIndexes, move } from 'ramda-adjunct';

export default function useTabState({ initialTags } = {}) {
  const [tags, setTags] = useState(initialTags || []);

  function addTag(name) {
    setTags([...tags, name]);
  }

  function removeTagAtIndex(index) {
    setTags(omitIndexes([index], tags));
  }

  function moveTagForward(index) {
    setTags(move(index, index - 1, tags));
  }

  function moveTagBackward(index) {
    setTags(move(index, index + 1, tags));
  }

  return {
    addTag,
    moveTagBackward,
    moveTagForward,
    removeTagAtIndex,
    tags,
  };
}
```

---

```jsx src/App.js
import Tag from './Tag';

export default function App() {
  return <Tag />;
}
```

---

```jsx src/App.js focus=2,5
import Tag from './Tag';
import useTagState from './useTagState';

export default function App() {
  const tagState = useTagState({ initialTags: ['foo', 'bar'] });

  return <Tag />;
}
```

---

```jsx src/App.js focus=7[15:27]
import Tag from './Tag';
import useTagState from './useTagState';

export default function App() {
  const tagState = useTagState({ initialTags: ['foo', 'bar'] });

  return <Tag {...tagState} />;
}
```

---

```jsx src/App.js
import Tag from './Tag';
import useTagState from './useTagState';

export default function App() {
  const tagStateA = useTagState({ initialTags: ['foo', 'bar'] });
  const tagStateB = useTagState({ initialTags: ['baz', 'bat'] });

  return (
    <>
      <Tag {...tagStateA} />
      <Tag {...tagStateB} />
    </>
  );
}
```

---

```jsx src/Tag.js focus=3,7:8
import React, { useState } from 'react';
import { AnimatePresence, m } from 'framer-motion';
import useTagState from './useTagState';

export default function Tag() {
  const [newLabel, setNewLabel] = useState('');
  const { addTag, moveTagBackward, moveTagForward, removeTagAtIndex, tags } =
    useTagState();

  const handleLabelChange = (event) => {
    setNewLabel(event.target.value);
  };

  const handleSubmit = (event) => {
    addTag?.(newLabel);
    setNewLabel('');
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={newLabel}
          onChange={handleLabelChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {tags?.length &&
          tags.map((name, i) => (
            <m.span
              key={i}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {name}
              <button disabled={i === 0} onClick={() => moveTagForward(i)}>
                ‚Äπ
              </button>
              <button
                disabled={tags?.length === i + 1}
                onClick={() => moveTagBackward(i)}
              >
                ‚Ä∫
              </button>
              <button onClick={() => removeTagAtIndex(i)}>‚úï</button>
            </m.span>
          ))}
      </AnimatePresence>
    </>
  );
}
```

---

```jsx src/Tag.js
import React, { useState } from 'react';
import { AnimatePresence, m } from 'framer-motion';

export default function Tag({
  addTag,
  moveTagBackward,
  moveTagForward,
  removeTagAtIndex,
  tags,
} = {}) {
  const [newLabel, setNewLabel] = useState('');

  const handleLabelChange = (event) => {
    setNewLabel(event.target.value);
  };

  const handleSubmit = (event) => {
    addTag?.(newLabel);
    setNewLabel('');
    event.preventDefault();
  };

  return (
    <>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={newLabel}
          onChange={handleLabelChange}
          placeholder="Add a tag..."
        />
      </form>
      <AnimatePresence>
        {tags?.map((name, i) => (
          <m.span
            key={i}
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
          >
            {name}
            <button disabled={i === 0} onClick={() => moveTagForward(i)}>
              ‚Äπ
            </button>
            <button
              disabled={tags?.length === i + 1}
              onClick={() => moveTagBackward(i)}
            >
              ‚Ä∫
            </button>
            <button onClick={() => removeTagAtIndex(i)}>‚úï</button>
          </m.span>
        ))}
      </AnimatePresence>
    </>
  );
}
```

---

```jsx src/App.js
import Tag from './Tag';
import useTagState from './useTagState';

export default function App() {
  const tagStateA = useTagState({ initialTags: ['foo', 'bar'] });
  const tagStateB = useTagState({ initialTags: ['baz', 'bat'] });

  return (
    <>
      <Tag {...tagStateA} />
      <Tag {...tagStateB} />
    </>
  );
}
```

---

```jsx src/App.js
import Tag from './Tag';
import useTagState from './useTagState';

export default function App() {
  const tagStateA = useTagState({ initialTags: ['foo', 'bar'] });
  const tagStateB = useTagState({ initialTags: ['baz', 'bat'] });

  return (
    <>
      <Tag />
      <Tag {...tagStateB} />
    </>
  );
}
```

---

```jsx src/App.js focus=7:11,17
import Tag from './Tag';
import useTagState from './useTagState';

export default function App() {
  const tagStateA = useTagState({ initialTags: ['foo', 'bar'] });
  const tagStateB = useTagState({ initialTags: ['baz', 'bat'] });
  const { removeTagAtIndex, ...tagStateC } = useTagState();
  function trackDelete(index) {
    removeTagAtIndex(index);
    alert(`Deleted tag at index ${index}`);
  }

  return (
    <>
      <Tag />
      <Tag {...tagStateB} />
      <Tag {...tagStateC} removeTagAtIndex={trackDelete} />
    </>
  );
}
```

---

```jsx src/App.js focus=12:15,22:25
import Tag from './Tag';
import useTagState from './useTagState';

export default function App() {
  const tagStateA = useTagState({ initialTags: ['foo', 'bar'] });
  const tagStateB = useTagState({ initialTags: ['baz', 'bat'] });
  const { removeTagAtIndex, ...tagStateC } = useTagState();
  function trackDelete(index) {
    removeTagAtIndex(index);
    alert(`Deleted tag at index ${index}`);
  }
  const tagStateD = useTagState();
  const { tags } = tagStateD;

  const myUrlParams = new URLSearchParams({ tags });

  return (
    <>
      <Tag />
      <Tag {...tagStateB} />
      <Tag {...tagStateC} removeTagAtIndex={trackDelete} />
      <Tag {...tagStateD} />
      <pre>
        <code>{myUrlParams.toString()}</code>
      </pre>
    </>
  );
}
```

---

<Slide isTop>

## What Next?

Start using encapsulated, portable custom hooks!

</Slide>

---

<Slide isTop>

## What Next?

Start using encapsulated, portable custom hooks!

- Find opportunities with new components

</Slide>

---

<Slide isTop>

## What Next?

Start using encapsulated, portable custom hooks!

- Find opportunities with new components
- Challenge yourself/team to compare APIs

</Slide>

---

<Slide isTop>

## What Next?

Start using encapsulated, portable custom hooks!

- Find opportunities with new components
- Challenge yourself/team to compare APIs
- Learn from prior art (Reakit, Ariakit, etc.)

</Slide>

---

<Slide columns={2}>

## Appendix

Built With, Inspired By, and Supplemental Resources

- [Code Hike](https://github.com/code-hike/codehike)
- [Framer Motion](https://github.com/framer/motion)
- [MDX](https://github.com/mdx-js/mdx)
- [Next.js](https://github.com/vercel/next.js)
- [NX](https://github.com/nrwl/nx)
- [React Flow](https://github.com/wbkd/react-flow)
- [water.css](https://github.com/kognise/water.css)
- [Reakit](https://reakit.io/)
- [Ariakit](https://github.com/ariakit/ariakit)

Source and Slides

- [https://portable-hooks.bje.co](https://portable-hooks.bje.co)
- [GitHub](https://github.com/brianespinosa/portable-hooks)

</Slide>

---

<Slide columns={2}>

# Thank You!

## Questions?

</Slide>

</CH.Slideshow>
